# Прогнозирование риска ДТП

## Обзор
Проект направлен на предсказание риска ДТП для каршеринговой компании с использованием исторических данных. Цель — оценить вероятность аварии с повреждением автомобиля (кроме царапин) на основе различных факторов, чтобы водители получали предупреждения и рекомендации, а компания могла оптимизировать работу автопарка.

Модель учитывает такие признаки, как:
- Время ДТП (день недели, час)
- Возраст автомобиля
- Погодные условия
- Состояние дорожного покрытия
- Страховая сумма
- Тип автомобиля и направление/локация

---

## Цели проекта
1. Создать модель предсказания ДТП с повреждением автомобиля.
2. Исключить случаи с повреждениями типа SCRATCH (царапина).
3. Использовать данные за 2012 год (самый полный период).
4. Учитывать возраст автомобиля.
5. Исследовать важность факторов ДТП.
6. Предоставить рекомендации по повышению безопасности и управлению автопарком.

---

## Данные
Датасет содержит исторические записи ДТП, включая:
- Время аварии (день недели, час)
- Возраст автомобиля
- Степень повреждений
- Погодные и дорожные условия
- Тип автомобиля
- Страховую сумму
- Локацию (направление, пересечение, расстояние от главной дороги)

**Примечание:** данные были отфильтрованы по автомобилям, исключены царапины и старые авто (>10 лет).

---

## Используемые признаки
- `weekday_hour`: сочетание дня недели и часа ДТП
- `vehicle_age`: возраст автомобиля в годах
- `weather`: погодные условия (`clear`, `cloudy`, `bad`)
- `road_surface`: состояние дорожного покрытия (`good`, `bad`)
- `insurance_premium`: страховая сумма
- `vehicle_type`: тип автомобиля
- `direction_location`: комбинированный признак направления и локации

---

## Подход к моделированию
1. **Предобработка данных**
   - Проверка и исправление названий столбцов и типов данных
   - Удаление дубликатов, заполнение пропусков
   - Объединение категорий, удаление выбросов

2. **Исследовательский анализ (EDA)**
   - Распределения признаков, корреляции
   - Анализ трендов по времени, визуализация аварий по часам и дням недели

3. **Моделирование**
   - Базовая модель: CatBoost с дефолтными параметрами
   - Продвинутые модели: LightGBM, нейронные сети
   - Метрики: ROC-AUC (основная), F1-score (дополнительно)
   - Важность признаков оценена через SHAP и permutation importance

4. **Результаты**
   - Лучшая модель: CatBoost (`depth=4`, `iterations=500`, `learning_rate=0.05`)
   - ROC-AUC на кросс-валидации: 0.72
   - Precision/Recall для положительного класса: 67% / 64.3%
   - Наиболее важные признаки: `insurance_premium`, `weekday_hour`, `vehicle_type`, `direction_location`

---

## Технологии / стек
- Python 3.9+
- Jupyter Notebook
- Pandas, NumPy
- Matplotlib, Seaborn, Plotly
- Scikit-learn
- CatBoost, LightGBM
- SHAP
- SQL (SQLite)
- Git/GitHub

---

## Использование
1. Клонировать репозиторий:
```bash
git clone https://github.com/Shostaklisa/road_accident_prediction.git
cd road_accident_prediction
